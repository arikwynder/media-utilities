foreach ($i in Get-Childitem -recurse -file -include *.wav ) {$k = $i.directoryname ; $j = [System.IO.Path]::GetFileNameWithoutExtension($i) ; $channels = (ffprobe -v error -select_streams a -show_entries stream=channels -of default=nk=1:nw=1 $i) ; if ($channels -eq 2) {Move-Item -literalpath $i -destination "2ch\$j.wav"} elseif ($channels -eq 6) {Move-Item -literalpath $i -destination "6ch\$j.wav"} elseif ($channels -eq 8) {Move-Item -literalpath $i -destination "8ch\$j.wav"} else {Write-Host "Error: $j " -Foregroundcolor Red} }